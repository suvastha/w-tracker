<!-- /weighty/templates/index.html -->
{% extends "base.html" %}
{% block content %}
<div class="space-y-4">
  <div class="p-3 bg-sky-50 dark:bg-sky-900/40 rounded border border-sky-200 dark:border-sky-800">
    <div class="flex items-start gap-3">
      <div class="text-2xl">ðŸ’¬</div>
      <div>
        <div class="font-semibold">Todayâ€™s nudge</div>
        <div class="opacity-80">{{ quote }}</div>
      </div>
    </div>
  </div>

  {% include "_cards.html" %}

  <div class="flex gap-2">
    <button id="btnAdd" class="btn-primary">+ Add weight</button>
    <button id="btnDetails" class="btn-secondary" data-toggle="details">Details</button>
    <button id="btnAverages" class="btn-secondary" data-toggle="averages">Averages</button>
    <button id="btnHeatmap" class="btn-secondary" data-toggle="heatmap">Heatmap</button>
  </div>

  <!-- Charts -->
  <section class="space-y-6">
    <div>
      <h2 class="section-title">Weight Trend</h2>
      <canvas id="chartTrend" height="140"></canvas>
    </div>
    <div>
      <h2 class="section-title">Trend vs Goal</h2>
      <canvas id="chartProjection" height="120"></canvas>
      <p class="text-sm opacity-70" id="etaText"></p>
    </div>
  </section>

  <!-- Toggles -->
  <section id="panel-details" class="toggle-panel hidden">
    <h2 class="section-title">Details</h2>
    <div id="tableContainer" class="overflow-x-auto">
      <table class="min-w-full text-sm">
        <thead><tr class="text-left">
          <th class="p-2">Date</th>
          <th class="p-2">Weight (kg)</th>
          <th class="p-2">Î”</th>
          <th class="p-2">BMI</th>
          <th class="p-2">Avg7</th>
          <th class="p-2">Avg30</th>
          <th class="p-2">Actions</th>
        </tr></thead>
        <tbody id="rowsBody"></tbody>
      </table>
    </div>
  </section>

  <section id="panel-averages" class="toggle-panel hidden">
    <h2 class="section-title">Averages</h2>
    <div class="grid grid-cols-2 sm:grid-cols-4 gap-3" id="avgCards"></div>
  </section>

  <section id="panel-heatmap" class="toggle-panel hidden">
    <h2 class="section-title">Consistency Heatmap</h2>
    <div id="heatmap" class="heatmap-grid"></div>
  </section>

  <div class="text-center py-8 opacity-70" id="emptyState" style="display:none;">
    No weights yet â€” tap the big button above to start ðŸ“ˆ
  </div>
</div>
{% endblock %}
